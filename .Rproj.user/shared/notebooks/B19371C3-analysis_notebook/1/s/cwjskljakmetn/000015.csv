"0","map5 <- data.frame()"
"0","for (i in unique(data_analysis_men$time)) {"
"0","  "
"0","set.seed(12)"
"0","fit <- data_analysis_men %>%"
"0","  filter(time == i) %>%"
"0","  select(M_Y00:`M_Y85+`) %>%"
"0","  scale() %>%"
"0","  kmeans(., centers=2, nstart=50)"
"0","j <- order(fit$cluster)"
"0","map5 <- map5 %>% bind_rows(data.frame(time = i, geo = filter(data_analysis_men, time == i)$geo[j], cluster=as.factor(fit$cluster[j])))"
"0","}"
"0","map5 <- map5 %>% inner_join(gisco, ., by = c(""NUTS_ID"" = ""geo""))"
"2","Column `NUTS_ID`/`geo` joining character vector and factor, coercing into character vector"
"0","require(forcats)"
"0","map5 <- map5 %>% mutate(cluster = ifelse(time %in% 2004:2012, fct_rev(cluster), cluster))"
"0","ggplot(map5) + "
"0","  geom_sf(aes(fill = factor(cluster)), color = ""transparent"") +"
"0","  geom_sf(fill = ""transparent"", size = 0.1, data = gisco0) +"
"0","  coord_sf(xlim = c(-10, +30), ylim = c(35, 70)) +"
"0","  facet_wrap(. ~ time, ncol = 5) +"
"0","  theme(panel.grid.major = element_line(colour = 'transparent'),"
"0","        axis.text.x=element_blank(),"
"0","        axis.ticks.x=element_blank(),"
"0","        axis.text.y=element_blank(),"
"0","        axis.ticks.y=element_blank()) +"
"0","  ggtitle(""Clustering EU regions (NUTS2) by Male Death Rates 2002 - 2016"") +"
"0","  labs(fill = ""Cluster"")"
