"0","data_analysis_men <- data_analysis_wide %>% "
"0","  select(geo, time, starts_with(""M_"")) %>% "
"0","  filter(time == 2010) %>% "
"0","  arrange(geo)"
"0","set.seed(123456789)"
"0","wssplot <- function(data, nc=15, seed=1234){"
"0","  wss <- (nrow(data)-1)*sum(apply(data,2,var))"
"0","  for (i in 2:nc){"
"0","    set.seed(seed)"
"0","    wss[i] <- sum(kmeans(data, centers=i)$withinss)}"
"0","  plot(1:nc, wss, type=""b"", xlab=""Number of Clusters"","
"0","       ylab=""Within groups sum of squares"")}"
"0","fit <- data_analysis_men %>% "
"0","  select(M_Y00:`M_Y85+`) %>%"
"0","  scale() %>%"
"0","  kmeans(., centers=2, nstart=10)"
"0","i <- order(fit$cluster)"
"0","map4 <- data.frame(year = 2010, geo=data_analysis_men$geo[i], cluster=fit$cluster[i]) %>%"
"0","  inner_join(gisco, ., by = c(""NUTS_ID"" = ""geo""))"
"2","Column `NUTS_ID`/`geo` joining character vector and factor, coercing into character vector"
"0","ggplot(map4) + "
"0","  geom_sf(aes(fill = factor(cluster)), colour = ""transparent"") +"
"0","    geom_sf(fill = ""transparent"", size = 0.1, data = gisco0) +"
"0","  coord_sf(xlim = c(-10, +30), ylim = c(35, 70)) +"
"0","  theme(panel.grid.major = element_line(colour = 'transparent'),"
"0","        axis.text.x=element_blank(),"
"0","        axis.ticks.x=element_blank(),"
"0","        axis.text.y=element_blank(),"
"0","        axis.ticks.y=element_blank()) +"
"0","  ggtitle(""Clustering EU regions (NUTS2) by Male Death Rates in 2010"") +"
"0","  labs(fill = ""Cluster"")"
